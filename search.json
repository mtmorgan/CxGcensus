[{"path":"https://mtmorgan.github.io/CxGcensus/articles/a_discovery_and_retrieval.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"A. Data Discovery and Retrieval","text":"Install CxGcensus GitHub :","code":"## install.packages(\"devtools\") devtools::install_github(\"mtmorgan/CxGcensus\")"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/a_discovery_and_retrieval.html","id":"data-exploration","dir":"Articles","previous_headings":"","what":"Data exploration","title":"A. Data Discovery and Retrieval","text":"Load package census package versions using Discover datasets used construct census dataset_id collection_id can used cellxgenedp package programmatic retrieval visualization individual datasets. organisms present census (use calls feature_data() observation_data()) available Summarize information cells census Learn features (genes) , e.g., homo_sapiens datasets census Observation (cell) data annotations available observation_data(). strategy adopted download data local duckdb database. Download can time-consuming, results ‘memoised’ subsequent calls --less instantaneous. columns available cross-dataset analysis straight-forward summarize query data, e.g., number different types assays represented, studies diabetes. Use ggplot2 visualize tissue type assay.  soma_joinid tibbles returned feature_data() observation_data() important retrieving counts.","code":"library(CxGcensus) census()$get_metadata() |>     lapply(as.vector) |>     str() #> List of 4 #>  $ created_on           : chr \"2023-05-15T22:34:37+00:00\" #>  $ git_commit_sha       : chr \"1598cfd\" #>  $ soma_encoding_version: chr \"1\" #>  $ soma_object_type     : chr \"SOMACollection\" packageVersion(\"CxGcensus\") #> [1] '0.0.0.9017' tiledbsoma::show_package_versions() #> tiledbsoma:    0.99.1 #> tiledb-r:      0.20.0 #> tiledb core:   2.16.0 #> libtiledbsoma: libtiledb=2.16.0 #> R:             R version 4.3.1 (2023-06-16) #> OS:            Ubuntu 22.04.2 LTS datasets() #> # A tibble: 562 × 8 #>    soma_joinid collection_id           collection_name collection_doi dataset_id #>          <int> <chr>                   <chr>           <chr>          <chr>      #>  1           0 6b701826-37bb-4356-979… Abdominal Whit… NA             9d8e5dca-… #>  2           1 4195ab4c-20bd-4cd3-8b3… A spatially re… NA             a6388a6f-… #>  3           2 4195ab4c-20bd-4cd3-8b3… A spatially re… NA             842c6f5d-… #>  4           3 4195ab4c-20bd-4cd3-8b3… A spatially re… NA             74520626-… #>  5           4 4195ab4c-20bd-4cd3-8b3… A spatially re… NA             396a9124-… #>  6           5 74e10dc4-cbb2-4605-a18… Spatial proteo… 10.1016/j.cel… e84f2780-… #>  7           6 74e10dc4-cbb2-4605-a18… Spatial proteo… 10.1016/j.cel… dfdf1ae2-… #>  8           7 74e10dc4-cbb2-4605-a18… Spatial proteo… 10.1016/j.cel… d1cbed97-… #>  9           8 74e10dc4-cbb2-4605-a18… Spatial proteo… 10.1016/j.cel… b03e4ef8-… #> 10           9 6d203948-a779-4b69-9b3… Differential c… 10.1016/j.cel… f1f123cc-… #> # ℹ 552 more rows #> # ℹ 3 more variables: dataset_title <chr>, dataset_h5ad_path <chr>, #> #   dataset_total_cell_count <int> census_names() #> [1] \"homo_sapiens\" \"mus_musculus\" summary_cell_counts() |>     filter(category == \"sex\") |>     select(         organism, label,         unique_cell_count, total_cell_count     ) #> # A tibble: 6 × 4 #>   organism     label   unique_cell_count total_cell_count #>   <chr>        <chr>               <int>            <int> #> 1 Homo sapiens female           14516846         22513226 #> 2 Homo sapiens male             17097019         28197731 #> 3 Homo sapiens unknown           2145022          3083771 #> 4 Mus musculus female            1066585          1431227 #> 5 Mus musculus male              1655113          2462185 #> 6 Mus musculus unknown            192620           192620 feature_data(\"mus_musculus\") #> # A tibble: 52,392 × 4 #>    soma_joinid feature_id         feature_name  feature_length #>          <int> <chr>              <chr>                  <int> #>  1           0 ENSMUSG00000109644 0610005C13Rik           3583 #>  2           1 ENSMUSG00000108652 0610006L08Rik           2128 #>  3           2 ENSMUSG00000007777 0610009B22Rik            998 #>  4           3 ENSMUSG00000086714 0610009E02Rik           1803 #>  5           4 ENSMUSG00000043644 0610009L18Rik            619 #>  6           5 ENSMUSG00000042208 0610010F05Rik           5226 #>  7           6 ENSMUSG00000020831 0610010K14Rik           1896 #>  8           7 ENSMUSG00000089755 0610012D04Rik            531 #>  9           8 ENSMUSG00000107002 0610012G03Rik           1445 #> 10           9 ENSMUSG00000046683 0610025J13Rik           1121 #> # ℹ 52,382 more rows mus <- observation_data(\"mus_musculus\") mus #> # Source:   table<obs> [?? x 21] #> # Database: DuckDB 0.8.1 [unknown@Linux 5.15.0-1041-azure:R 4.3.1//home/runner/.cache/R/CxGcensus/25273ae9f274.duckdb] #>    soma_joinid dataset_id                 assay assay_ontology_term_id cell_type #>        <int64> <chr>                      <chr> <chr>                  <chr>     #>  1           0 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  2           1 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  3           2 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesothel… #>  4           3 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  5           4 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  6           5 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            intersti… #>  7           6 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  8           7 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #>  9           8 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            Sertoli … #> 10           9 be46dfdc-0f99-4731-8957-6… 10x … EFO:0011025            mesenchy… #> # ℹ more rows #> # ℹ 16 more variables: cell_type_ontology_term_id <chr>, #> #   development_stage <chr>, development_stage_ontology_term_id <chr>, #> #   disease <chr>, disease_ontology_term_id <chr>, donor_id <chr>, #> #   is_primary_data <lgl>, self_reported_ethnicity <chr>, #> #   self_reported_ethnicity_ontology_term_id <chr>, sex <chr>, #> #   sex_ontology_term_id <chr>, suspension_type <chr>, tissue <chr>, … mus |>     colnames() #>  [1] \"soma_joinid\"                              #>  [2] \"dataset_id\"                               #>  [3] \"assay\"                                    #>  [4] \"assay_ontology_term_id\"                   #>  [5] \"cell_type\"                                #>  [6] \"cell_type_ontology_term_id\"               #>  [7] \"development_stage\"                        #>  [8] \"development_stage_ontology_term_id\"       #>  [9] \"disease\"                                  #> [10] \"disease_ontology_term_id\"                 #> [11] \"donor_id\"                                 #> [12] \"is_primary_data\"                          #> [13] \"self_reported_ethnicity\"                  #> [14] \"self_reported_ethnicity_ontology_term_id\" #> [15] \"sex\"                                      #> [16] \"sex_ontology_term_id\"                     #> [17] \"suspension_type\"                          #> [18] \"tissue\"                                   #> [19] \"tissue_ontology_term_id\"                  #> [20] \"tissue_general\"                           #> [21] \"tissue_general_ontology_term_id\" mus |>     count(assay, sort = TRUE) #> # Source:     SQL [9 x 2] #> # Database:   DuckDB 0.8.1 [unknown@Linux 5.15.0-1041-azure:R 4.3.1//home/runner/.cache/R/CxGcensus/25273ae9f274.duckdb] #> # Ordered by: desc(n) #>   assay                                n #>   <chr>                          <int64> #> 1 10x 3' v3                      1925688 #> 2 10x 3' v2                      1622998 #> 3 Smart-seq2                      221648 #> 4 10x 5' v1                       161525 #> 5 Drop-seq                         80990 #> 6 Smart-seq                        48972 #> 7 10x 3' v1                        21421 #> 8 DroNc-seq                         2768 #> 9 10x 3' transcription profiling      22 mus |>     filter(grepl(\"diabetes\", disease)) |>     count(disease, sex, tissue) #> # Source:   SQL [2 x 4] #> # Database: DuckDB 0.8.1 [unknown@Linux 5.15.0-1041-azure:R 4.3.1//home/runner/.cache/R/CxGcensus/25273ae9f274.duckdb] #>   disease                  sex    tissue                    n #>   <chr>                    <chr>  <chr>               <int64> #> 1 type 2 diabetes mellitus male   islet of Langerhans   99747 #> 2 type 1 diabetes mellitus female islet of Langerhans   39932 library(ggplot2)  ## 10 most-common tissues; total cell count common_tissues <-     mus |>     count(tissue, sort = TRUE) |>     head(10) |>     collect() |>     pull(tissue) ## assays on each tissue tissue_and_assay <-     mus |>     filter(tissue %in% common_tissues) |>     count(tissue, assay, sort = TRUE) |>     collect() ## visualize ggplot(tissue_and_assay) +     aes(x = factor(tissue, levels = common_tissues), y = n, fill = assay) +     geom_bar(position=\"stack\", stat=\"identity\") +     labs(x = \"Tissue\", y = \"Total cell count\") +     coord_flip() +     theme(legend.position = c(.8, .7)) #> Warning: Removed 28 rows containing missing values (`position_stack()`)."},{"path":"https://mtmorgan.github.io/CxGcensus/articles/a_discovery_and_retrieval.html","id":"experiment-retrieval-as-singlecellexperiment","dir":"Articles","previous_headings":"","what":"Experiment retrieval as SingleCellExperiment","title":"A. Data Discovery and Retrieval","text":"create Bioconductor SingleCellExperiment, perhaps use one Orchestrating Single Cell Analysis Bioconductor (OSCA) workflows, first select desired features observations. illustration choose 100 random genes choose cells brain tissue development stage 20 month old latter. Cells several datasets Use create SingleCellExperiment. experiment counts() sparse (dgCMatrix, Matrix package) matrix, features observations available (Bioconductor DataFrame objects, rather tibbles) via rowData() colData(). data straight-forward work , e.g., removing features counts observed… … summarizing total number reads observed cell","code":"set.seed(12) features <- feature_data(\"mus_musculus\") random_features <-     features |>     slice(sample(nrow(features), 100)) observations <- observation_data(\"mus_musculus\") brain_20mo <-     observations |>     filter(         tissue == \"brain\",         development_stage == \"20 month-old stage and over\"     ) |>     collect() brain_20mo |>     count() #> # A tibble: 1 × 1 #>       n #>   <int> #> 1 52132 brain_20mo |>     count(dataset_id) #> # A tibble: 5 × 2 #>   dataset_id                               n #>   <chr>                                <int> #> 1 3bbb6cf9-72b9-41be-b568-656de6eb18b5 38695 #> 2 58b01044-c5e5-4b0f-8a2d-6ebf951e01ff  3077 #> 3 66ff82b4-9380-469c-bc4b-cfa08eacd325   756 #> 4 98e5ea9f-16d6-47ec-a529-686e76515e39  5180 #> 5 c08f8441-4a10-4748-872a-e70c0bcccdba  4424 sce <- single_cell_experiment(\"mus_musculus\", random_features, brain_20mo) #> creating axis and experiment queries #> retrieving assay_data measurement 'RNA' collection 'X' layer 'raw' as a #> sparse matrix with 100 x 52132 distinct features x observations sce #> class: SingleCellExperiment  #> dim: 100 52132  #> metadata(1): census_metadata #> assays(1): counts #> rownames: NULL #> rowData names(4): soma_joinid feature_id feature_name feature_length #> colnames: NULL #> colData names(21): soma_joinid dataset_id ... tissue_general #>   tissue_general_ontology_term_id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): library(SingleCellExperiment) keep_rows <- Matrix::rowSums(counts(sce, withDimnames = FALSE)) != 0 table(keep_rows) #> keep_rows #> FALSE  TRUE  #>    56    44 sce[keep_rows,] #> class: SingleCellExperiment  #> dim: 44 52132  #> metadata(1): census_metadata #> assays(1): counts #> rownames: NULL #> rowData names(4): soma_joinid feature_id feature_name feature_length #> colnames: NULL #> colData names(21): soma_joinid dataset_id ... tissue_general #>   tissue_general_ontology_term_id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0): hist(     log1p(colSums(counts(sce, withDimnames = FALSE))),     main = \"Counts per cell\",     xlab = \"log(1 + x) counts\", )"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/a_discovery_and_retrieval.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"A. Data Discovery and Retrieval","text":"article compiled CxGcensus version 0.0.0.9017. Full session info :","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2 #>  [3] Biobase_2.60.0              GenomicRanges_1.52.0        #>  [5] GenomeInfoDb_1.36.1         IRanges_2.34.1              #>  [7] S4Vectors_0.38.1            BiocGenerics_0.46.0         #>  [9] MatrixGenerics_1.12.2       matrixStats_1.0.0           #> [11] ggplot2_3.4.2               CxGcensus_0.0.0.9017        #> [13] RcppSpdlog_0.0.14           dplyr_1.1.2                 #>  #> loaded via a namespace (and not attached): #>  [1] tidyselect_1.2.0            blob_1.2.4                  #>  [3] urltools_1.7.3              arrow_12.0.1                #>  [5] bitops_1.0-7                fastmap_1.1.1               #>  [7] RCurl_1.98-1.12             duckdb_0.8.1                #>  [9] digest_0.6.33               lifecycle_1.0.3             #> [11] magrittr_2.0.3              compiler_4.3.1              #> [13] rlang_1.1.1                 sass_0.4.7                  #> [15] tools_4.3.1                 utf8_1.2.3                  #> [17] yaml_2.3.7                  data.table_1.14.8           #> [19] knitr_1.43                  S4Arrays_1.0.4              #> [21] bit_4.0.5                   spdl_0.0.5                  #> [23] curl_5.0.1                  DelayedArray_0.26.6         #> [25] aws.signature_0.6.0         xml2_1.3.5                  #> [27] withr_2.5.0                 purrr_1.0.1                 #> [29] desc_1.4.2                  triebeard_0.4.1             #> [31] grid_4.3.1                  fansi_1.0.4                 #> [33] colorspace_2.1-0            scales_1.2.1                #> [35] cli_3.6.1                   crayon_1.5.2                #> [37] rmarkdown_2.23              ragg_1.2.5                  #> [39] generics_0.1.3              tiledbsoma_0.99.1           #> [41] httr_1.4.6                  DBI_1.1.3                   #> [43] cachem_1.0.8                stringr_1.5.0               #> [45] zlibbioc_1.46.0             assertthat_0.2.1            #> [47] XVector_0.40.0              base64enc_0.1-3             #> [49] vctrs_0.6.3                 Matrix_1.5-4.1              #> [51] jsonlite_1.8.7              bit64_4.0.5                 #> [53] systemfonts_1.0.4           jquerylib_0.1.4             #> [55] glue_1.6.2                  pkgdown_2.0.7               #> [57] stringi_1.7.12              gtable_0.3.3                #> [59] aws.s3_0.3.21               munsell_0.5.0               #> [61] nanotime_0.3.7              tibble_3.2.1                #> [63] pillar_1.9.0                htmltools_0.5.5             #> [65] GenomeInfoDbData_1.2.10     R6_2.5.1                    #> [67] dbplyr_2.3.3                textshaping_0.3.6           #> [69] rprojroot_2.0.3             evaluate_0.21               #> [71] lattice_0.21-8              RcppCCTZ_0.2.12             #> [73] highr_0.10                  cellxgene.census_0.0.0.9000 #> [75] memoise_2.0.1               tiledb_0.20.0               #> [77] bslib_0.5.0                 rjsoncons_1.0.0             #> [79] Rcpp_1.0.11                 xfun_0.39                   #> [81] fs_1.6.2                    zoo_1.8-12                  #> [83] pkgconfig_2.0.3"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/b_integration.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"B. Dataset Integration","text":"work flow emulates ‘Integrating multi-dataset slices data’ cellxgene-census tutorial, although integtation path uses Bioconductor packages. Start loading CxGcensus SingleCellExperiment packages.","code":"library(CxGcensus) library(SingleCellExperiment)"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/b_integration.html","id":"datasets-and-observations","dir":"Articles","previous_headings":"","what":"Datasets and observations","title":"B. Dataset Integration","text":"Select ‘Tabula Muris Sensis’ collection datasets containing ‘liver’ title. Retrieve observations (cells) datasets. Summarize observations assay. two datasets, one 10x Genomics Smart-seq2. dataset consists several male female donors various developmental stage. Retrieve observations SingleCellExperiment. Add feature_id (.e., Ensembl gene identifiers) row names downstream analysis.","code":"liver <-     datasets() |>     dplyr::filter(         collection_name == \"Tabula Muris Senis\",         grepl(\"liver\", dataset_title, ignore.case = TRUE)     ) liver #> # A tibble: 2 × 8 #>   soma_joinid collection_id            collection_name collection_doi dataset_id #>         <int> <chr>                    <chr>           <chr>          <chr>      #> 1         494 0b9d8a04-bb9d-44da-aa27… Tabula Muris S… 10.1038/s4158… 4546e757-… #> 2         516 0b9d8a04-bb9d-44da-aa27… Tabula Muris S… 10.1038/s4158… 6202a243-… #> # ℹ 3 more variables: dataset_title <chr>, dataset_h5ad_path <chr>, #> #   dataset_total_cell_count <int> dataset_ids <- pull(liver, dataset_id) observations <-      observation_data(\"mus_musculus\") |>     dplyr::filter(dataset_id %in% dataset_ids) |>     dplyr::collect() observations |>     dplyr::count(dataset_id, assay) #> # A tibble: 2 × 3 #>   dataset_id                           assay          n #>   <chr>                                <chr>      <int> #> 1 4546e757-34d0-4d17-be06-538318925fcd Smart-seq2  2859 #> 2 6202a243-b713-4e12-9ced-c387f8483dea 10x 3' v2   7294 observations |>     dplyr::count(dataset_id, donor_id, sex, development_stage) #> # A tibble: 21 × 5 #>    dataset_id                           donor_id sex    development_stage      n #>    <chr>                                <chr>    <chr>  <chr>              <int> #>  1 4546e757-34d0-4d17-be06-538318925fcd 18_45_M  male   18 month-old stage   275 #>  2 4546e757-34d0-4d17-be06-538318925fcd 18_46_F  female 18 month-old stage   533 #>  3 4546e757-34d0-4d17-be06-538318925fcd 18_53_M  male   18 month-old stage   372 #>  4 4546e757-34d0-4d17-be06-538318925fcd 24_58_M  male   20 month-old stag…   508 #>  5 4546e757-34d0-4d17-be06-538318925fcd 24_59_M  male   20 month-old stag…   440 #>  6 4546e757-34d0-4d17-be06-538318925fcd 3_11_M   male   3 month-old stage    420 #>  7 4546e757-34d0-4d17-be06-538318925fcd 3_56_F   female 3 month-old stage     82 #>  8 4546e757-34d0-4d17-be06-538318925fcd 3_57_F   female 3 month-old stage     79 #>  9 4546e757-34d0-4d17-be06-538318925fcd 3_9_M    male   3 month-old stage    150 #> 10 6202a243-b713-4e12-9ced-c387f8483dea 1-M-62   male   4 weeks              471 #> # ℹ 11 more rows sce <- single_cell_experiment(     \"mus_musculus\", feature_data(\"mus_musculus\"), observations ) #> creating axis and experiment queries #> retrieving assay_data measurement 'RNA' collection 'X' layer 'raw' as a #> sparse matrix with 52392 x 10153 distinct features x observations rownames(sce) <- rowData(sce)$feature_id sce #> class: SingleCellExperiment  #> dim: 52392 10153  #> metadata(1): census_metadata #> assays(1): counts #> rownames(52392): ENSMUSG00000109644 ENSMUSG00000108652 ... #>   ENSMUSG00000118538 ENSMUSG00000084217 #> rowData names(4): soma_joinid feature_id feature_name feature_length #> colnames: NULL #> colData names(21): soma_joinid dataset_id ... tissue_general #>   tissue_general_ontology_term_id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/b_integration.html","id":"single-dataset-processing","dir":"Articles","previous_headings":"","what":"Single dataset processing","title":"B. Dataset Integration","text":"deviate cellxgene-census tutorial performing preliminary steps data set. prelminary QC, normalization, variance modeling dimensionality reduction dataset separately, Following Chapter 1 ‘Multisample’ section Orchestrating Single Cell Analysis Bioconductor. ’ll use following packages Start creating separate Smart-seq2 10x SingleCellExperiments. Smart-seq2 mRNA represents entire expressed protien, longer genes inherently mRNA. Try correct dividing read counts gene length. set metadata() Smart-seq2 dataset empty list, metadata duplicated two datasets combined later stage. following code chunk, Chapter 1, performs step Smart-seq2 10x datasets. Bind resulting objects together","code":"library(scater) library(scran) library(BiocSingular) smartseq <- sce[, sce$assay == \"Smart-seq2\"] tenx <- sce[, sce$assay != \"Smart-seq2\"] x <- counts(smartseq, withDimnames = FALSE) x <- t( t(x) / rowData(smartseq)$feature_length ) counts(smartseq, withDimnames = FALSE) <- x metadata(smartseq) <- list() ## A list of SingleCellExperiments all.sce <- list(smartseq = smartseq, tenx = tenx)  ## QC -- skip currently; no MT gene expression  ## Normalization -- scater all.sce <- lapply(all.sce, logNormCounts)  ## Variance modelling -- scran all.dec <- lapply(all.sce, modelGeneVar) all.hvgs <- lapply(all.dec, getTopHVGs, prop=0.1)  ## Dimensionality reduction -- BiocSingular set.seed(10000) all.sce <- Map(     runPCA, x = all.sce, subset_row = all.hvgs,      MoreArgs = list(ncomponents = 25L, BSPARAM = RandomParam()) )  set.seed(100000) all.sce <- lapply(all.sce, runTSNE, dimred = \"PCA\")  set.seed(1000000) all.sce <- lapply(all.sce, runUMAP, dimred = \"PCA\")  ## Clustering for (n in names(all.sce)) {     g <- buildSNNGraph(all.sce[[n]], k=10, use.dimred='PCA')     clust <- igraph::cluster_walktrap(g)$membership     colLabels(all.sce[[n]])  <- factor(clust) } sce <- do.call(\"cbind\", all.sce) sce #> class: SingleCellExperiment  #> dim: 52392 10153  #> metadata(1): census_metadata #> assays(2): counts logcounts #> rownames(52392): ENSMUSG00000109644 ENSMUSG00000108652 ... #>   ENSMUSG00000118538 ENSMUSG00000084217 #> rowData names(4): soma_joinid feature_id feature_name feature_length #> colnames: NULL #> colData names(23): soma_joinid dataset_id ... sizeFactor label #> reducedDimNames(3): PCA TSNE UMAP #> mainExpName: NULL #> altExpNames(0):"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/b_integration.html","id":"dataset-integration","dir":"Articles","previous_headings":"","what":"Dataset integration","title":"B. Dataset Integration","text":"use batchelor package dataset integration. Following Chapter 1, quickCorrect() implements workflow dataset integration includes identifying shared features, scaling batches account differences sequencing depth, computation log-normalized expression values, identification highly variable genes. Data integration uses mutual nearest neighbor (MNN) correction. Visualize final result interactive UMAP using plotUMAP() plotly package; WebGL() makes plot interactive even 100’s thousands cells…","code":"library(batchelor) ## batchelor quick.corrected <- quickCorrect(     all.sce[[1]], all.sce[[2]],     precomputed = all.dec,     PARAM = FastMnnParam(BSPARAM=BiocSingular::RandomParam()) )  quick.sce <- quick.corrected$corrected ## include colData from original sce colData(quick.sce) <- cbind(colData(sce), colData(quick.sce)) quick.sce$batch <- factor(quick.sce$batch) quick.sce #> class: SingleCellExperiment  #> dim: 52392 10153  #> metadata(2): merge.info pca.info #> assays(1): reconstructed #> rownames(52392): ENSMUSG00000109644 ENSMUSG00000108652 ... #>   ENSMUSG00000118538 ENSMUSG00000084217 #> rowData names(1): rotation #> colnames: NULL #> colData names(24): soma_joinid dataset_id ... label batch #> reducedDimNames(1): corrected #> mainExpName: NULL #> altExpNames(0): ## scater set.seed(00101010) quick.sce <- runTSNE(quick.sce, dimred = \"corrected\") quick.sce <- runUMAP(quick.sce, dimred = \"corrected\")  plotUMAP(quick.sce, colour_by=\"cell_type\") |>     plotly::ggplotly() |>     plotly::toWebGL()"},{"path":"https://mtmorgan.github.io/CxGcensus/articles/b_integration.html","id":"session-information","dir":"Articles","previous_headings":"","what":"Session information","title":"B. Dataset Integration","text":"article compiled CxGcensus version 0.0.0.9017 following packages","code":"sessionInfo() #> R version 4.3.1 (2023-06-16) #> Platform: x86_64-pc-linux-gnu (64-bit) #> Running under: Ubuntu 22.04.2 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats4    stats     graphics  grDevices utils     datasets  methods   #> [8] base      #>  #> other attached packages: #>  [1] batchelor_1.16.0            BiocSingular_1.16.0         #>  [3] scran_1.28.1                scater_1.28.0               #>  [5] ggplot2_3.4.2               scuttle_1.10.1              #>  [7] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2 #>  [9] Biobase_2.60.0              GenomicRanges_1.52.0        #> [11] GenomeInfoDb_1.36.1         IRanges_2.34.1              #> [13] S4Vectors_0.38.1            BiocGenerics_0.46.0         #> [15] MatrixGenerics_1.12.2       matrixStats_1.0.0           #> [17] CxGcensus_0.0.0.9017        RcppSpdlog_0.0.14           #> [19] dplyr_1.1.2                 #>  #> loaded via a namespace (and not attached): #>   [1] jsonlite_1.8.7              magrittr_2.0.3              #>   [3] ggbeeswarm_0.7.2            rmarkdown_2.23              #>   [5] fs_1.6.2                    zlibbioc_1.46.0             #>   [7] ragg_1.2.5                  vctrs_0.6.3                 #>   [9] memoise_2.0.1               DelayedMatrixStats_1.22.1   #>  [11] RCurl_1.98-1.12             base64enc_0.1-3             #>  [13] htmltools_0.5.5             S4Arrays_1.0.4              #>  [15] curl_5.0.1                  BiocNeighbors_1.18.0        #>  [17] sass_0.4.7                  bslib_0.5.0                 #>  [19] htmlwidgets_1.6.2           desc_1.4.2                  #>  [21] plotly_4.10.2               zoo_1.8-12                  #>  [23] cachem_1.0.8                ResidualMatrix_1.10.0       #>  [25] igraph_1.5.0                lifecycle_1.0.3             #>  [27] pkgconfig_2.0.3             rsvd_1.0.5                  #>  [29] Matrix_1.5-4.1              R6_2.5.1                    #>  [31] fastmap_1.1.1               GenomeInfoDbData_1.2.10     #>  [33] digest_0.6.33               colorspace_2.1-0            #>  [35] tiledb_0.20.0               rprojroot_2.0.3             #>  [37] dqrng_0.3.0                 irlba_2.3.5.1               #>  [39] crosstalk_1.2.0             aws.signature_0.6.0         #>  [41] textshaping_0.3.6           beachmat_2.16.0             #>  [43] labeling_0.4.2              fansi_1.0.4                 #>  [45] urltools_1.7.3              httr_1.4.6                  #>  [47] compiler_4.3.1              bit64_4.0.5                 #>  [49] withr_2.5.0                 BiocParallel_1.34.2         #>  [51] viridis_0.6.3               DBI_1.1.3                   #>  [53] rjsoncons_1.0.0             duckdb_0.8.1                #>  [55] DelayedArray_0.26.6         bluster_1.10.0              #>  [57] tiledbsoma_0.99.1           tools_4.3.1                 #>  [59] vipor_0.4.5                 beeswarm_0.4.0              #>  [61] glue_1.6.2                  cellxgene.census_0.0.0.9000 #>  [63] grid_4.3.1                  Rtsne_0.16                  #>  [65] cluster_2.1.4               generics_0.1.3              #>  [67] gtable_0.3.3                tidyr_1.3.0                 #>  [69] data.table_1.14.8           ScaledMatrix_1.8.1          #>  [71] metapod_1.8.0               xml2_1.3.5                  #>  [73] utf8_1.2.3                  XVector_0.40.0              #>  [75] RcppAnnoy_0.0.21            ggrepel_0.9.3               #>  [77] pillar_1.9.0                stringr_1.5.0               #>  [79] limma_3.56.2                lattice_0.21-8              #>  [81] FNN_1.1.3.2                 bit_4.0.5                   #>  [83] tidyselect_1.2.0            locfit_1.5-9.8              #>  [85] knitr_1.43                  gridExtra_2.3               #>  [87] edgeR_3.42.4                RcppCCTZ_0.2.12             #>  [89] xfun_0.39                   statmod_1.5.0               #>  [91] stringi_1.7.12              lazyeval_0.2.2              #>  [93] yaml_2.3.7                  evaluate_0.21               #>  [95] codetools_0.2-19            tibble_3.2.1                #>  [97] cli_3.6.1                   uwot_0.1.16                 #>  [99] arrow_12.0.1                systemfonts_1.0.4           #> [101] munsell_0.5.0               jquerylib_0.1.4             #> [103] Rcpp_1.0.11                 triebeard_0.4.1             #> [105] dbplyr_2.3.3                parallel_4.3.1              #> [107] ellipsis_0.3.2              pkgdown_2.0.7               #> [109] assertthat_0.2.1            blob_1.2.4                  #> [111] aws.s3_0.3.21               sparseMatrixStats_1.12.2    #> [113] bitops_1.0-7                spdl_0.0.5                  #> [115] viridisLite_0.4.2           scales_1.2.1                #> [117] purrr_1.0.1                 crayon_1.5.2                #> [119] rlang_1.1.1                 cowplot_1.1.1               #> [121] nanotime_0.3.7"},{"path":"https://mtmorgan.github.io/CxGcensus/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Martin Morgan. Author, maintainer. Chan Zuckerberg Initiative DAF CZF2019-002443. Funder.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Morgan M (2023). CxGcensus: Discover Retrieve 'CELLxGENE' Census Data Sets. R package version 0.0.0.9017, https://mtmorgan.github.io/CxGcensus/.","code":"@Manual{,   title = {CxGcensus: Discover and Retrieve 'CELLxGENE' Census Data Sets},   author = {Martin Morgan},   year = {2023},   note = {R package version 0.0.0.9017},   url = {https://mtmorgan.github.io/CxGcensus/}, }"},{"path":"https://mtmorgan.github.io/CxGcensus/index.html","id":"cxgcensus","dir":"","previous_headings":"","what":"Discover and Retrieve CELLxGENE Census Data Sets ","title":"Discover and Retrieve CELLxGENE Census Data Sets ","text":"CxGcensus alternative R client CELLxGENE census. emaphsizes use cases related data discovery, uses -memory -disk caches reduce latency associated repeated queries. CELLxGENE census internet resource providing access hundreds human mouse single-cell RNA-seq datasets. ‘CxGcensus’ interface resource, allowing discovery download datasets, features (genes), observations (individual cells) across experiments. Datasets, features, observations accessible familiar ‘tibbles’; measures single-cell expression presented R / Bioconductor ‘SingleCellExperiment’ data representation easy integration , example, ‘Orchestrating Single-Cell Analysis Bioconductor’ (OSCA). CxGcensus avialable CRAN Bioconductor, can installed using remotes package. CxGcensus imports two packages available CRAN. tiledbsoma, supported Windows, must installed source, C++ code requires correctly installed compiler (see instructions macOS XCode installation). Install CxGcensus GitHub : also install cellxgene.census CxGcensus uses arrow ‘dataset’ capabilities, must case returns TRUE. case linux, macOS binary installations CRAN. needed install arrow source macOS, success cloning arrow GitHub repository, checking current release tag, forcing use autobrew Articles available exploration include . Data Discovery Retrieval B. Dataset Integeration C. Comparison CuratedAtlasQuery cellxgene.census","code":"if (!\"remotes\" %in% rownames(installed.packages()))     install.packages(\"remotes\", repos = \"https://cran.r-project.org\") remotes::install_git(     \"https://github.com/single-cell-data/TileDB-SOMA.git\",     subdir = \"apis/r\" ) remotes::install_github(\"mtmorgan/CxGcensus\") arrow::arrow_info()$capabilities[[\"dataset\"]] git clone https://github.com/apache/arrow/ cd arrow/R git checkout apache-arrow-12.0.0 FORCE_AUTOBREW=true R CMD INSTALL ."},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":null,"dir":"Reference","previous_headings":"","what":"On-disk cache management — cache_directory","title":"On-disk cache management — cache_directory","text":"cache_directory() reports path -disk cache particular census. cache_info() summarizes file size last modification time files cache. cache() returns object used manage cache.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"On-disk cache management — cache_directory","text":"","code":"cache_directory(id = census_id())  cache_info(id = census_id())  cache(id = census_id())"},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"On-disk cache management — cache_directory","text":"id character(1) unique identifier associated particular census snapshot, returned census_id().","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"On-disk cache management — cache_directory","text":"cache_directory() returns character(1) file path location cache associated census id. cache_info() returns tibble file name, size, 'mtime' (last-modified time). mtime used cache_disk() manage size age objects cache. cache() returns object created cachem::chach_disk() can used query delete items cache.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"On-disk cache management — cache_directory","text":"-disk cache created managed cache_disk() function cachem package. Consult package details working object. File names cache hash function arguments body cache; possible know transparently file corresponds memoized function.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/cache.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"On-disk cache management — cache_directory","text":"","code":"cache_directory() #> [1] \"/home/runner/.cache/R/CxGcensus/1598cfd\"  cache_info() #> # A tibble: 0 × 4 #> # ℹ 4 variables: file <chr>, size <dbl>, mtime <dttm>, path <chr>  cache() #> <cache_disk> <cachem> #>   Methods: #>     get(key, missing = missing_) #>     set(key, value) #>     exists(key) #>     keys() #>     remove(key) #>     reset() #>     prune() #>     size() #>     destroy() #>     is_destroyed(throw = FALSE) #>     info()"},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"census() queries CELLxGENE particulalr census. census_id() reports unique identifier particular census version. census_names() queries census available 'experiments'. CELLxGENE, experiments correspond organisms, e.g., \"homo_sapiens\" \"mus_musculus\".","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"","code":"census(census_version = \"stable\", uri = NULL, tiledbsoma_ctx = NULL)  census_id(...)  census_names(...)"},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"census_version see ?cellxgene.census::open_soma uri see ?cellxgene.census::open_soma tiledbsoma_ctx see ?cellxgene.census::open_soma ... arguments passed census(). census object returned census(); present, overrides specifications ....","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"census() returns tiledbsoma::SOMACollection object. Details census_version available census()$get_metadata() census_id() returns 7-character git commit sha uniquely identifies current release census. census_names() returns character vector possible values. Use values calls , e.g., feature_data() observation_data().","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"census() 'memoised', requiring high-latency internet access first use.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Obtain a reference to a CELLxGENE 'SOMA' collection — census","text":"","code":"census() #> <SOMACollection> #>   uri: s3://cellxgene-data-public/cell-census/2023-05-15/soma/  #>   groups: census_data*, census_info*  census()$get_metadata() #> $created_on #> [1] \"2023-05-15T22:34:37+00:00\" #> attr(,\"key\") #> [1] \"created_on\" #>  #> $git_commit_sha #> [1] \"1598cfd\" #> attr(,\"key\") #> [1] \"git_commit_sha\" #>  #> $soma_encoding_version #> [1] \"1\" #> attr(,\"key\") #> [1] \"soma_encoding_version\" #>  #> $soma_object_type #> [1] \"SOMACollection\" #> attr(,\"key\") #> [1] \"soma_object_type\" #>   census_id() #> [1] \"1598cfd\"  census_names() #> [1] \"homo_sapiens\" \"mus_musculus\"  tiledbsoma::show_package_versions() #> tiledbsoma:    0.99.1 #> tiledb-r:      0.20.0 #> tiledb core:   2.16.0 #> libtiledbsoma: libtiledb=2.16.0 #> R:             R version 4.3.1 (2023-06-16) #> OS:            Ubuntu 22.04.2 LTS"},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":null,"dir":"Reference","previous_headings":"","what":"Discover census datasets, cells, features, and observations — datasets","title":"Discover census datasets, cells, features, and observations — datasets","text":"datasets() queries CELLxGENE datasets used constructing census. summary_cell_counts() reports facets (e.g., sex) levels (e.g., male, female) census, number cells associated facet level. feature_data() reports information features (genes) present census. observation_data() reports information cells census. assay_data() queries census 'raw' counts RNA-seq data corresponding selected features columns census. single_cell_experiment() queries census assay data corresponding features observations, assembles result SingleCellExperiment. count data accessible using SingleCellExperiment::counts().","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Discover census datasets, cells, features, and observations — datasets","text":"","code":"datasets(...)  summary_cell_counts(...)  feature_data(organism, ...)  observation_data(organism, ...)  assay_data(organism, features, observations, ...)  single_cell_experiment(organism, features, observations, ...)"},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Discover census datasets, cells, features, and observations — datasets","text":"... arguments passed census(), specifying census release used. missing, default (current stable) census used. organism one values returned census_names(), specifically 'homo_sapiens' 'mus_musculus' time writing documentation. features tibble, typically derived feature_data() via filter(), select(), etc., containing soma_joinid column. observations tibble, typically derived observation_data() via filter(), select(), etc., containing soma_joinid column.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Discover census datasets, cells, features, and observations — datasets","text":"datasets() returns tibble information collections datasets represented census. summary_cell_counts() returns tibble summarizing organism, facets (category, e.g., 'sex') levels (label, e.g., 'female') represented data, unique total cell counts facet level. feature_data() returns tibble columns describing feature (gene) organism. observation_data() returns dbplyr-based tibble cell annotations. aesthetic problem 'connection' database available user, duckdb warns Database garbage-collected...; message can ignored. assay_data() returns sparse matrix (dgCMatrix) summarizing counts found census soma_joinid columns features observations tibble arguments. counts 'raw' layer' 'X' collection 'RNA' measurement experiment.","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Discover census datasets, cells, features, and observations — datasets","text":"datasets(), summary_cell_counts(), feature_data() 'memoised' expensive first use. 'tibble' returned functions memoised disk, re-using function fast even across sessions. See ?cache_info() details cache management. observation_data() memoised disk. data large (e.g., 50 million rows Homo sapiens) initial download can time-consuming (10's minutes). download interactive session, number 'chunks' records displayed; 2023-05-15 census homo_sapiens, 52 million records (cells) downloaded 124 chunks. data stored 'duckdb' database. return value can used via dbplyr fast memory efficient filtering, selection, summary. Currently, assay_data() single_cell_experiment(), user must ensure features, observations, assay data census organism. Duplicate rows features observations allowed. single_cell_experiment() requires SingleCellExperiment Biocductor package installed, e.g., via BiocManager::install(\"SingleCellExperiment\").","code":""},{"path":"https://mtmorgan.github.io/CxGcensus/reference/census_info.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Discover census datasets, cells, features, and observations — datasets","text":"","code":"datasets() |>     glimpse() #> Rows: 562 #> Columns: 8 #> $ soma_joinid              <int> 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13,… #> $ collection_id            <chr> \"6b701826-37bb-4356-9792-ff41fc4c3161\", \"4195… #> $ collection_name          <chr> \"Abdominal White Adipose Tissue\", \"A spatiall… #> $ collection_doi           <chr> NA, NA, NA, NA, NA, \"10.1016/j.cell.2021.12.0… #> $ dataset_id               <chr> \"9d8e5dca-03a3-457d-b7fb-844c75735c83\", \"a638… #> $ dataset_title            <chr> \"22 integrated samples\", \"scRNA-seq data - my… #> $ dataset_h5ad_path        <chr> \"9d8e5dca-03a3-457d-b7fb-844c75735c83.h5ad\", … #> $ dataset_total_cell_count <int> 72335, 30789, 714331, 76567, 12510, 167598, 4…  summary_cell_counts() |>     count(category) #> # A tibble: 9 × 2 #>   category                    n #>   <chr>                   <int> #> 1 all                         2 #> 2 assay                      29 #> 3 cell_type                 830 #> 4 disease                    73 #> 5 self_reported_ethnicity    27 #> 6 sex                         6 #> 7 suspension_type             2 #> 8 tissue                    278 #> 9 tissue_general             88  ## number of cells from female, male, and 'unknown' samples in ## humans and mice summary_cell_counts() |>     filter(category == \"sex\") |>     select(         organism, label,         unique_cell_count, total_cell_count     ) #> # A tibble: 6 × 4 #>   organism     label   unique_cell_count total_cell_count #>   <chr>        <chr>               <int>            <int> #> 1 Homo sapiens female           14516846         22513226 #> 2 Homo sapiens male             17097019         28197731 #> 3 Homo sapiens unknown           2145022          3083771 #> 4 Mus musculus female            1066585          1431227 #> 5 Mus musculus male              1655113          2462185 #> 6 Mus musculus unknown            192620           192620  feature_data(\"mus_musculus\") #> # A tibble: 52,392 × 4 #>    soma_joinid feature_id         feature_name  feature_length #>          <int> <chr>              <chr>                  <int> #>  1           0 ENSMUSG00000109644 0610005C13Rik           3583 #>  2           1 ENSMUSG00000108652 0610006L08Rik           2128 #>  3           2 ENSMUSG00000007777 0610009B22Rik            998 #>  4           3 ENSMUSG00000086714 0610009E02Rik           1803 #>  5           4 ENSMUSG00000043644 0610009L18Rik            619 #>  6           5 ENSMUSG00000042208 0610010F05Rik           5226 #>  7           6 ENSMUSG00000020831 0610010K14Rik           1896 #>  8           7 ENSMUSG00000089755 0610012D04Rik            531 #>  9           8 ENSMUSG00000107002 0610012G03Rik           1445 #> 10           9 ENSMUSG00000046683 0610025J13Rik           1121 #> # ℹ 52,382 more rows  mus <- observation_data(\"mus_musculus\") mus |>     count(assay, sort = TRUE) #> # Source:     SQL [9 x 2] #> # Database:   DuckDB 0.8.1 [unknown@Linux 5.15.0-1041-azure:R 4.3.1//home/runner/.cache/R/CxGcensus/25273ae9f274.duckdb] #> # Ordered by: desc(n) #>   assay                                n #>   <chr>                          <int64> #> 1 10x 3' v3                      1925688 #> 2 10x 3' v2                      1622998 #> 3 Smart-seq2                      221648 #> 4 10x 5' v1                       161525 #> 5 Drop-seq                         80990 #> 6 Smart-seq                        48972 #> 7 10x 3' v1                        21421 #> 8 DroNc-seq                         2768 #> 9 10x 3' transcription profiling      22 mus |>     filter(grepl(\"diabetes\", disease)) |>     count(disease, sex, tissue) #> # Source:   SQL [2 x 4] #> # Database: DuckDB 0.8.1 [unknown@Linux 5.15.0-1041-azure:R 4.3.1//home/runner/.cache/R/CxGcensus/25273ae9f274.duckdb] #>   disease                  sex    tissue                    n #>   <chr>                    <chr>  <chr>               <int64> #> 1 type 2 diabetes mellitus male   islet of Langerhans   99747 #> 2 type 1 diabetes mellitus female islet of Langerhans   39932  features <-    feature_data(\"mus_musculus\") |>    ## rows 4, 3, 4 of the tibble    slice(c(4:3, 4))  observations <-    observation_data(\"mus_musculus\") |>    ## first two rows of the tibble    head(2) |>    collect()  counts <- assay_data(features, observations, organism = \"mus_musculus\") #> creating axis and experiment queries #> retrieving assay_data measurement 'RNA' collection 'X' layer 'raw' as a #> sparse matrix with 2 x 2 distinct features x observations  single_cell_experiment(\"mus_musculus\", features, observations) #> class: SingleCellExperiment  #> dim: 3 2  #> metadata(1): census_metadata #> assays(1): counts #> rownames: NULL #> rowData names(4): soma_joinid feature_id feature_name feature_length #> colnames: NULL #> colData names(21): soma_joinid dataset_id ... tissue_general #>   tissue_general_ontology_term_id #> reducedDimNames(0): #> mainExpName: NULL #> altExpNames(0):"}]
